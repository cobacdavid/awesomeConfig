--#!/usr/bin/lua

require ( "io" )
require ( "os" )

local dir = "/home/david/.config/awesome"
local fic = dir  .. "/liste_fichiers_lua_conky"

local dst          = "/tmp/"
local dstFile = "awesome_config.tgz"
local dstConky     = dst .. "/conky"
local dstAwesome   = dst .. "/awesome"
local dstFinal     = "/travail/david/production/info/config/awesome/"

os.execute ( "mkdir -p " .. dstConky)

local tar     = "tar czf"
local af      = dst .. "/" .. dstFile

-- creation des repertoires dans le /tmp
for line in io.lines( fic ) do
   if string.match ( line , ".*conky.*" ) then
      os.execute ( "cp " .. line .. " " .. dstConky )
   elseif string.match ( line , ".*awesome.*" ) then
      -- on copie tout le repertoire
      os.execute ( "cp -r " .. line .. " " .. dst )
   end
end
-- creation du tarball
os.execute ( "cd " .. dst .. " && " .. tar .. " " .. af  .. " conky/ awesome/" )
os.execute ( "mv " .. af ..  " " .. dstFinal )